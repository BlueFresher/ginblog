{"ast":null,"code":"const columns = [{\n  title: 'ID',\n  dataIndex: 'ID',\n  width: '5%',\n  key: 'id',\n  align: 'center'\n}, {\n  title: '分类',\n  dataIndex: 'Category.name',\n  width: '5%',\n  key: 'name',\n  align: 'center'\n}, {\n  title: '文章标题',\n  dataIndex: 'title',\n  width: '15%',\n  key: 'title',\n  align: 'center'\n}, {\n  title: '文章描述',\n  dataIndex: 'desc',\n  width: '20%',\n  key: 'desc',\n  align: 'center'\n}, {\n  title: '缩略图',\n  dataIndex: 'img',\n  width: '20%',\n  key: 'img',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'img'\n  }\n}, {\n  title: '操作',\n  width: '20%',\n  key: 'action',\n  align: 'center',\n  scopedSlots: {\n    customRender: 'action'\n  }\n}];\nexport default {\n  data() {\n    return {\n      pagination: {\n        pageSizeOptions: ['5', '10', '20'],\n        pageSize: 5,\n        total: 0,\n        showSizeChanger: true,\n        showTotal: total => `共${total}条`\n      },\n      Artlist: [],\n      CateList: [],\n      columns,\n      queryParam: {\n        title: '',\n        pagesize: 5,\n        pagenum: 1\n      }\n    };\n  },\n  created() {\n    this.getArtList();\n    this.getCateList();\n  },\n  methods: {\n    // 查询文章列表\n    async getArtList() {\n      const {\n        data: res\n      } = await this.$http.get('article', {\n        params: {\n          title: this.queryParam.title,\n          pagesize: this.queryParam.pagesize,\n          pagenum: this.queryParam.pagenum\n        }\n      });\n      console.log(res);\n      if (res.status != 200) return this.$message.error(res.message);\n      this.Artlist = res.data;\n      this.paginationOption.total = res.total;\n    },\n    // 获取分类\n    async getCateList() {\n      const {\n        data: res\n      } = await this.$http.get('category');\n      console.log(res);\n      if (res.status != 200) return this.$message.error(res.message);\n      this.CateList = res.data;\n      this.paginationOption.total = res.total;\n    },\n    // 更改分页\n    handleTableChange(pagination, filters, sorter) {\n      var pager = {\n        ...this.pagination\n      };\n      pager.current = pagination.current;\n      pager.pageSize = pagination.pageSize;\n      this.queryParam.pagesize = pagination.pageSize;\n      this.queryParam.pagenum = pagination.current;\n      if (pagination.pageSize !== this.pagination.pageSize) {\n        this.queryParam.pagenum = 1;\n        pager.current = 1;\n      }\n      this.pagination = pager;\n      this.getArtList();\n    },\n    // 删除文章\n    deleteArt(id) {\n      this.$confirm({\n        title: '提示：请再次确认',\n        content: '确认要删除该文章么？一旦删除无法恢复',\n        onOk: async () => {\n          const res = await this.$http.delete(`article/${id}`);\n          if (res.status != 200) return this.$message.error(res.message);\n          this.$message.success('删除成功');\n          this.getArtList();\n          console.log(res);\n        },\n        onCancel: () => {\n          this.$message.info('已取消删除');\n        }\n      });\n    },\n    // 查询分类下的文章\n    CateChange(value) {\n      this.getCateArt(value);\n    },\n    async getCateArt(id) {\n      const {\n        data: res\n      } = await this.$http.get(`article/list/${id}`);\n      if (res.status != 200) return this.$message.error(res.message);\n      this.ArtList = res.data;\n      this.paginationOption.total = res.total;\n    }\n  }\n};","map":{"version":3,"mappings":"AA2CA,iBACA;EACAA;EACAC;EACAC;EACAC;EACAC;AACA,GACA;EACAJ;EACAC;EACAC;EACAC;EACAC;AACA,GACA;EACAJ;EACAC;EACAC;EACAC;EACAC;AACA,GACA;EACAJ;EACAC;EACAC;EACAC;EACAC;AACA,GACA;EACAJ;EACAC;EACAC;EACAC;EACAC;EACAC;IAAAC;EAAA;AACA,GACA;EACAN;EACAE;EACAC;EACAC;EACAC;IAAAC;EAAA;AACA,EACA;AAEA;EACAC;IACA;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MAEAC;MACAC;MACAC;MACAC;QACAjB;QACAkB;QACAC;MACA;IACA;EACA;EACAC;IACA;IACA;EACA;EACAC;IACA;IACA;MACA;QAAAd;MAAA;QACAe;UACAtB;UACAkB;UACAC;QACA;MACA;MACAI;MACA;MACA;MACA;IACA;IACA;IACA;MACA;QAAAhB;MAAA;MACAgB;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;QAAA;MAAA;MACAC;MACAA;MACA;MACA;MAEA;QACA;QACAA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;QACA1B;QACA2B;QACAC;UACA;UACA;UACA;UACA;UACAL;QACA;QACAM;UACA;QACA;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;MACA;QAAAvB;MAAA;MACA;MACA;MACA;IACA;EACA;AACA","names":["title","dataIndex","width","key","align","scopedSlots","customRender","data","pagination","pageSizeOptions","pageSize","total","showSizeChanger","showTotal","Artlist","CateList","columns","queryParam","pagesize","pagenum","created","methods","params","console","handleTableChange","pager","deleteArt","content","onOk","onCancel","CateChange"],"sourceRoot":"src/components/article","sources":["ArtList.vue"],"sourcesContent":["<template>\n    <div>\n        <h3>文章列表页面</h3>\n        <a-card>\n            <a-row :gutter=\"20\">\n                <a-col :span=\"6\">\n                    <a-input-search v-model=\"queryParam.title\" placeholder=\"输入文章名查找\" enter-button allowClear @search=\"getArtList\"/>\n                </a-col>\n                <a-col :span=\"4\">\n                    <a-button type=\"primary\" @click=\"$router.push('/addart')\">新增</a-button>\n                </a-col>\n\n                <a-col :span=\"6\" :offset=\"4\">\n                    <a-select defaultValue=\"请选择分类\" style=\"width:200px\" @change=\"CateChange\">\n                    <a-select-option v-for=\"item in CateList\" :key=\"item.id\" :value=\"item.id\">{{item.name}}</a-select-option>\n                    </a-select>\n                </a-col>\n            </a-row>\n\n            <a-table \n                rowKey=\"ID\"\n                :columns=\"columns\"\n                :pagination='pagination' \n                :dataSource=\"Artlist\"\n                bordered\n                @change=\"handleTableChange\"\n                >\n                <span class=\"ArtImg\" slot=\"img\" slot-scope=\"img\">\n                    <img :src=\"img\" />\n                </span>\n                <template slot=\"action\" slot-scope=\"data\">\n                    <div class=\"actionSlot\">\n                        <a-button type=\"primary\" icon=\"edit\" style=\"margin-right:15px\" @click=\"$router.push(`/addart/${data.ID}`)\">编辑</a-button>\n                        <a-button type=\"danger\" icon=\"delete\" style=\"margin-right:15px\" @click=\"deleteArt(data.ID)\">删除</a-button>\n                    </div>\n                </template>\n            </a-table>\n\n        </a-card>\n    </div>\n</template>\n\n<script>\nconst columns = [\n    {\n        title: 'ID',\n        dataIndex: 'ID',\n        width:'5%',\n        key: 'id',\n        align:'center',\n   },\n   {\n        title: '分类',\n        dataIndex: 'Category.name',\n        width:'5%',\n        key: 'name',\n        align:'center',\n   },\n   {\n        title: '文章标题',\n        dataIndex: 'title',\n        width:'15%',\n        key: 'title',\n        align:'center',\n   },\n   {\n        title: '文章描述',\n        dataIndex: 'desc',\n        width:'20%',\n        key: 'desc',\n        align:'center',\n   },\n   {\n        title: '缩略图',\n        dataIndex: 'img',\n        width:'20%',\n        key: 'img',\n        align:'center',\n        scopedSlots:{customRender:'img'},\n   },\n   {\n        title: '操作',\n        width:'20%',\n        key: 'action',\n        align:'center',\n        scopedSlots:{customRender:'action'},\n   },\n]\n\nexport default{\n    data(){\n        return {\n            pagination:{\n                pageSizeOptions:['5', '10', '20'],\n                pageSize:5,\n                total:0,\n                showSizeChanger:true,\n                showTotal:(total)=>`共${total}条`,\n            },\n\n            Artlist:[],\n            CateList:[],\n            columns,\n            queryParam:{\n                title:'',\n                pagesize:5,\n                pagenum:1,\n            },\n        }\n    },\n    created(){\n        this.getArtList()\n        this.getCateList()\n    },\n    methods:{\n        // 查询文章列表\n        async getArtList() {\n            const { data:res } = await this.$http.get('article', {\n                params:{\n                    title:this.queryParam.title,\n                    pagesize:this.queryParam.pagesize, \n                    pagenum:this.queryParam.pagenum\n                }\n            })\n            console.log(res)\n            if (res.status != 200) return this.$message.error(res.message)\n            this.Artlist = res.data\n            this.paginationOption.total = res.total\n        },\n        // 获取分类\n        async getCateList() {\n            const { data:res } = await this.$http.get('category')\n            console.log(res)\n            if (res.status != 200) return this.$message.error(res.message)\n            this.CateList = res.data\n            this.paginationOption.total = res.total\n        },\n        // 更改分页\n        handleTableChange(pagination, filters, sorter) {\n            var pager = { ...this.pagination }\n            pager.current = pagination.current\n            pager.pageSize = pagination.pageSize\n            this.queryParam.pagesize = pagination.pageSize\n            this.queryParam.pagenum = pagination.current\n\n            if (pagination.pageSize !== this.pagination.pageSize) {\n                this.queryParam.pagenum = 1\n                pager.current = 1\n            }\n            this.pagination = pager\n            this.getArtList()\n        },\n        // 删除文章\n        deleteArt(id) {\n            this.$confirm({\n                title: '提示：请再次确认',\n                content: '确认要删除该文章么？一旦删除无法恢复',\n                onOk: async () => {\n                    const res = await this.$http.delete(`article/${id}`)\n                    if (res.status != 200) return this.$message.error(res.message)\n                    this.$message.success('删除成功')\n                    this.getArtList()\n                    console.log(res)\n                },\n                onCancel: () => {\n                    this.$message.info('已取消删除')\n                },\n            });\n        },\n        // 查询分类下的文章\n        CateChange(value) {\n            this.getCateArt(value)\n        },\n        async getCateArt(id) {\n            const {data: res} = await this.$http.get(`article/list/${id}`)\n            if (res.status != 200) return this.$message.error(res.message)\n            this.ArtList = res.data\n            this.paginationOption.total = res.total\n        }\n    },\n}\n</script>\n\n<style scoped>\n.actionSlot{\n    display: flex;\n    justify-content: center;\n\n}\n.ArtImg {\n    width:100%;\n    height:100%;\n}\n.ArtImg img{\n    width:100px;\n    height:80px;\n}\n</style>"]},"metadata":{},"sourceType":"module"}