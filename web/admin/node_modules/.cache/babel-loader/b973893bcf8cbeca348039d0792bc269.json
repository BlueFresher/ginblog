{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { Url } from '../../plugin/http';\nexport default {\n  data() {\n    return {\n      profileInfo: {\n        id: 1,\n        name: '',\n        desc: '',\n        qq_chat: '',\n        wechat: '',\n        weibo: '',\n        github: '',\n        email: '',\n        img: '',\n        avatar: '',\n        icp_record: ''\n      },\n      upUrl: Url + '/upload',\n      headers: {}\n    };\n  },\n  created() {\n    this.getProfileInfo();\n    this.headers = {\n      Authorization: `Bearer ${window.sessionStorage.getItem('token')}`\n    };\n  },\n  methods: {\n    // 获取个人设置\n    async getProfileInfo() {\n      const {\n        data: res\n      } = await this.$http.get(`admin/profile/${this.profileInfo.id}`);\n      console.log(res);\n      if (res.status !== 200) {\n        if (res.status === 1004 || 1005 || 1006 || 1007) {\n          window.sessionStorage.clear();\n          this.$router.push('/login');\n        }\n        this.$message.error(res.message);\n      }\n      this.profileInfo = res.data;\n    },\n    // 上传头像\n    avatarChange(info) {\n      if (info.file.status !== 'uploading') {}\n      if (info.file.status === 'done') {\n        this.$message.success(`图片上传成功`);\n        const imgUrl = info.file.response.url;\n        this.profileInfo.avatar = imgUrl;\n      } else if (info.file.status === 'error') {\n        this.$message.error(`图片上传失败`);\n      }\n    },\n    // 上传头像背景图\n    imgChange(info) {\n      if (info.file.status !== 'uploading') {}\n      if (info.file.status === 'done') {\n        this.$message.success(`图片上传成功`);\n        const imgUrl = info.file.response.url;\n        this.profileInfo.img = imgUrl;\n      } else if (info.file.status === 'error') {\n        this.$message.error(`图片上传失败`);\n      }\n    },\n    // 更新\n    async updateProfile() {\n      const {\n        data: res\n      } = await this.$http.put(`profile/${this.profileInfo.id}`, this.profileInfo);\n      if (res.status !== 200) return this.$message.error(res.message);\n      this.$message.success(`个人信息更新成功`);\n      this.$router.push('/index');\n    }\n  }\n};","map":{"version":3,"mappings":";AA8EA;AAEA;EACAA;IACA;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACA;MAAAC;IAAA;EACA;EACAC;IACA;IACA;MACA;QAAAjB;MAAA;MACAkB;MACA;QACA;UACAC;UACA;QACA;QACA;MACA;MACA;IACA;IAEA;IACAC;MACA,uCACA;MACA;QACA;QACA;QACA;MACA;QACA;MACA;IACA;IAEA;IACAC;MACA,uCACA;MACA;QACA;QACA;QACA;MACA;QACA;MACA;IACA;IAEA;IACA;MACA;QAAArB;MAAA;MACA;MACA;MACA;IACA;EACA;AACA","names":["data","profileInfo","id","name","desc","qq_chat","wechat","weibo","github","email","img","avatar","icp_record","upUrl","headers","created","Authorization","methods","console","window","avatarChange","imgChange"],"sourceRoot":"src/components/user","sources":["Profile.vue"],"sourcesContent":["<template>\n    <a-card>\n      <a-form-model labelAlign=\"left\" :label-col=\"{ span: 2 }\" :wrapper-col=\"{ span: 12 }\">\n        <a-form-model-item label=\"作者名称\">\n          <a-input style=\"width: 300px\" v-model=\"profileInfo.name\"></a-input>\n        </a-form-model-item>\n  \n        <a-form-model-item label=\"个人简介\">\n          <a-input type=\"textarea\" v-model=\"profileInfo.desc\"></a-input>\n        </a-form-model-item>\n  \n        <a-form-model-item label=\"网站备案号\">\n          <a-input style=\"width: 300px\" v-model=\"profileInfo.icp_record\"></a-input>\n        </a-form-model-item>\n  \n        <a-form-model-item label=\"QQ号码\">\n          <a-input style=\"width: 300px\" v-model=\"profileInfo.qq_chat\"></a-input>\n        </a-form-model-item>\n  \n        <a-form-model-item label=\"微信\">\n          <a-input style=\"width: 300px\" v-model=\"profileInfo.wechat\"></a-input>\n        </a-form-model-item>\n  \n        <a-form-model-item label=\"微博\">\n          <a-input style=\"width: 300px\" v-model=\"profileInfo.weibo\"></a-input>\n        </a-form-model-item>\n  \n        <a-form-model-item label=\"github\">\n          <a-input style=\"width: 300px\" v-model=\"profileInfo.github\"></a-input>\n        </a-form-model-item>\n  \n        <a-form-model-item label=\"Email\">\n          <a-input style=\"width: 300px\" v-model=\"profileInfo.email\"></a-input>\n        </a-form-model-item>\n  \n        <a-form-model-item label=\"头像\">\n          <a-upload\n            listType=\"picture\"\n            name=\"file\"\n            :action=\"upUrl\"\n            :headers=\"headers\"\n            @change=\"avatarChange\"\n          >\n            <a-button style=\"margin-right:10px\">\n              <a-icon type=\"upload\" />点击上传\n            </a-button>\n  \n            <template v-if=\"profileInfo.avatar\">\n              <img :src=\"profileInfo.avatar\" style=\"width: 120px; height: 100px\" />\n            </template>\n          </a-upload>\n        </a-form-model-item>\n  \n        <a-form-model-item label=\"头像背景图\">\n          <a-upload\n            listType=\"picture\"\n            name=\"file\"\n            :action=\"upUrl\"\n            :headers=\"headers\"\n            @change=\"imgChange\"\n          >\n            <a-button style=\"margin-right:10px\">\n              <a-icon type=\"upload\" />点击上传\n            </a-button>\n  \n            <template v-if=\"profileInfo.img\">\n              <img :src=\"profileInfo.img\" style=\"width: 120px; height: 100px\" />\n            </template>\n          </a-upload>\n        </a-form-model-item>\n  \n        <a-form-model-item>\n          <a-button type=\"danger\" style=\"margin-right: 15px\" @click=\"updateProfile\">更新</a-button>\n        </a-form-model-item>\n      </a-form-model>\n    </a-card>\n  </template>\n  <script>\n  import { Url } from '../../plugin/http'\n  \n  export default {\n    data() {\n      return {\n        profileInfo: {\n          id: 1,\n          name: '',\n          desc: '',\n          qq_chat: '',\n          wechat: '',\n          weibo: '',\n          github: '',\n          email: '',\n          img: '',\n          avatar: '',\n          icp_record: '',\n        },\n        upUrl: Url + '/upload',\n        headers: {},\n      }\n    },\n    created() {\n      this.getProfileInfo()\n      this.headers = { Authorization: `Bearer ${window.sessionStorage.getItem('token')}` }\n    },\n    methods: {\n      // 获取个人设置\n      async getProfileInfo() {\n        const { data: res } = await this.$http.get(`admin/profile/${this.profileInfo.id}`)\n        console.log(res)\n        if (res.status !== 200) {\n          if (res.status === 1004 || 1005 || 1006 || 1007) {\n            window.sessionStorage.clear()\n            this.$router.push('/login')\n          }\n          this.$message.error(res.message)\n        }\n        this.profileInfo = res.data\n      },\n  \n      // 上传头像\n      avatarChange(info) {\n        if (info.file.status !== 'uploading') {\n        }\n        if (info.file.status === 'done') {\n          this.$message.success(`图片上传成功`)\n          const imgUrl = info.file.response.url\n          this.profileInfo.avatar = imgUrl\n        } else if (info.file.status === 'error') {\n          this.$message.error(`图片上传失败`)\n        }\n      },\n  \n      // 上传头像背景图\n      imgChange(info) {\n        if (info.file.status !== 'uploading') {\n        }\n        if (info.file.status === 'done') {\n          this.$message.success(`图片上传成功`)\n          const imgUrl = info.file.response.url\n          this.profileInfo.img = imgUrl\n        } else if (info.file.status === 'error') {\n          this.$message.error(`图片上传失败`)\n        }\n      },\n  \n      // 更新\n      async updateProfile() {\n        const { data: res } = await this.$http.put(`profile/${this.profileInfo.id}`, this.profileInfo)\n        if (res.status !== 200) return this.$message.error(res.message)\n        this.$message.success(`个人信息更新成功`)\n        this.$router.push('/index')\n      },\n    },\n  }\n  </script>\n  \n  <style scoped>\n  .upBtn {\n    margin-right: 10px;\n  }\n  </style>"]},"metadata":{},"sourceType":"module"}