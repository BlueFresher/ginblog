{"ast":null,"code":"import tinymce from 'tinymce/tinymce';\nimport Editor from '@tinymce/tinymce-vue';\nimport 'tinymce/themes/silver';\nimport 'tinymce/plugins/textcolor';\nimport 'tinymce/plugins/advlist';\nimport 'tinymce/plugins/table';\nimport 'tinymce/plugins/lists';\nimport 'tinymce/plugins/paste';\nimport 'tinymce/plugins/preview';\nimport 'tinymce/plugins/fullscreen';\nimport 'tinymce/plugins/save';\nimport 'tinymce/plugins/image';\nimport 'tinymce/icons/default/icons';\nimport { appRequestFormData, appRequest, appRequestFile } from '@/fetch/index.js';\nimport qs from 'qs';\nexport default {\n  name: '',\n  components: {\n    Editor\n  },\n  data() {\n    return {\n      tinymceFlag: 1,\n      editorInit: {\n        language_url: '/tinymce/zh_CN.js',\n        language: 'zh_CN',\n        skin_url: '/tinymce/skins/ui/oxide',\n        height: 500,\n        browser_spellcheck: true,\n        // 拼写检查\n        branding: false,\n        // 去水印\n        elementpath: false,\n        // 禁用编辑器底部的状态栏\n        statusbar: false,\n        // 隐藏编辑器底部的状态栏\n        paste_data_images: true,\n        // 允许粘贴图像\n        menubar: false,\n        // 隐藏最上方menu\n        plugins: 'save advlist table lists paste preview fullscreen image',\n        toolbar: 'fontselect fontsizeselect forecolor backcolor bold italic underline strikethrough save image| alignleft aligncenter alignright alignjustify | quicklink h2 h3 blockquote table numlist bullist preview fullscreen',\n        images_upload_handler: function (blobInfo, success, failure) {\n          var formData;\n          var file = blobInfo.blob(); // 转化为易于理解的file对象\n          formData = new FormData();\n          formData.append('file', file, file.name); // 此处与源文档不一样\n          appRequestFile('/upload/simple?moudle=cms', formData, 'post').then(res => {\n            success(res.data.data.filePath);\n          });\n        },\n        paste_preprocess: function (plugin, args) {\n          console.log('---paster');\n        }\n      },\n      detailFormAdd: {\n        articleContent: ''\n      },\n      formRule: {\n        articleContent: [{\n          required: true,\n          message: '请编写资讯内容',\n          trigger: 'blur'\n        }, {\n          min: 1,\n          max: 1000000,\n          message: '请编写资讯内容',\n          trigger: 'blur'\n        }]\n      },\n      setHeader: {\n        token: token\n      }\n    };\n  },\n  mounted() {\n    var self = this;\n    tinymce.init({});\n  },\n  activated() {\n    this.tinymceFlag++;\n  },\n  methods: {\n    submit() {\n      this.$refs.detailFormAdd.validate(valid => {\n        if (valid) {\n          appRequestFormData('/sys/cms/save', qs.stringify(this.detailFormAdd), 'post').then(res => {\n            this.$message(res.data.msg);\n            this.$router.go(-1);\n          });\n        } else {\n          this.$message({\n            type: 'error',\n            message: '请完整表单信息'\n          });\n          return false;\n        }\n      });\n    },\n    cancel() {\n      this.$confirm('确定要取消吗？', '确定取消', {\n        type: 'warning'\n      }).then(() => {\n        this.$router.go(-1);\n      });\n    }\n  },\n  created() {}\n};","map":{"version":3,"mappings":"AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;EACAA;EACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QACAC;QACAC;UACA;UACA;UACAC;UACAA;UACAC;YACAC;UACA;QACA;QACAC;UACAC;QACA;MACA;MACAC;QACAC;MACA;MACAC;QACAD,iBACA;UAAAE;UAAAC;UAAAC;QAAA,GACA;UAAAC;UAAAC;UAAAH;UAAAC;QAAA;MAEA;MACAG;QACAC;MACA;IACA;EACA;EACAC;IACA;IACAC;EACA;EACAC;IACA;EACA;EACAC;IACAC;MACA;QACA;UACAC;YACA;YACA;UACA;QACA;UACA;YACAC;YACAZ;UACA;UACA;QACA;MACA;IACA;IACAa;MACA;QACAD;MACA,GACAE;QACA;MACA;IACA;EACA;EACAC,WACA;AACA","names":["name","components","Editor","data","tinymceFlag","editorInit","language_url","language","skin_url","height","browser_spellcheck","branding","elementpath","statusbar","paste_data_images","menubar","plugins","toolbar","images_upload_handler","formData","appRequestFile","success","paste_preprocess","console","detailFormAdd","articleContent","formRule","required","message","trigger","min","max","setHeader","token","mounted","tinymce","activated","methods","submit","appRequestFormData","type","cancel","then","created"],"sourceRoot":"src/components/editor","sources":["index.vue"],"sourcesContent":["<template>\n  <div class=\"privateLetter mt20\">\n    <el-form size=\"small\" label-width=\"150px\" ref=\"detailFormAdd\" :model=\"detailFormAdd\" label-positon=\"left\" :rules=\"formRule\">\n      <el-row>\n        <el-col :span=\"20\" :offset=\"1\">\n          <el-form-item  class=\"filter-item is-required\" label=\"资讯内容：\" prop=\"articleContent\">\n             <!-- 富文本编辑器 -->\n             <Editor id=\"tinymce\" v-model=\"detailFormAdd.articleContent\" :init=\"editorInit\" :key=\"tinymceFlag\"></Editor>\n          </el-form-item>\n        </el-col>\n      </el-row>\n      <div class=\"mt20 tc mb20\">\n        <el-button type=\"primary\" size=\"medium\" @click=\"submit()\">保存</el-button>\n      </div>\n    </el-form>\n  </div>\n</template>\n<script>\nimport tinymce from 'tinymce/tinymce'\nimport Editor from '@tinymce/tinymce-vue'\nimport 'tinymce/themes/silver'\nimport 'tinymce/plugins/textcolor'\nimport 'tinymce/plugins/advlist'\nimport 'tinymce/plugins/table'\nimport 'tinymce/plugins/lists'\nimport 'tinymce/plugins/paste'\nimport 'tinymce/plugins/preview'\nimport 'tinymce/plugins/fullscreen'\nimport 'tinymce/plugins/save'\nimport 'tinymce/plugins/image'\nimport 'tinymce/icons/default/icons'\n \nimport { appRequestFormData, appRequest, appRequestFile } from '@/fetch/index.js'\nimport qs from 'qs'\nexport default {\n  name: '',\n  components: {\n    Editor\n  },\n  data () {\n    return {\n      tinymceFlag: 1,\n      editorInit: {\n        language_url: '/tinymce/zh_CN.js',\n        language: 'zh_CN',\n        skin_url: '/tinymce/skins/ui/oxide',\n        height: 500,\n        browser_spellcheck: true, // 拼写检查\n        branding: false, // 去水印\n        elementpath: false, // 禁用编辑器底部的状态栏\n        statusbar: false, // 隐藏编辑器底部的状态栏\n        paste_data_images: true, // 允许粘贴图像\n        menubar: false, // 隐藏最上方menu\n        plugins: 'save advlist table lists paste preview fullscreen image',\n        toolbar: 'fontselect fontsizeselect forecolor backcolor bold italic underline strikethrough save image| alignleft aligncenter alignright alignjustify | quicklink h2 h3 blockquote table numlist bullist preview fullscreen',\n        images_upload_handler: function (blobInfo, success, failure) {\n          var formData\n          var file = blobInfo.blob() // 转化为易于理解的file对象\n          formData = new FormData()\n          formData.append('file', file, file.name) // 此处与源文档不一样\n          appRequestFile('/upload/simple?moudle=cms', formData, 'post').then((res) => {\n            success(res.data.data.filePath)\n          })\n        },\n        paste_preprocess: function (plugin, args) {\n          console.log('---paster')\n        }\n      },\n      detailFormAdd: {\n        articleContent: ''\n      },\n      formRule: {\n        articleContent: [\n          { required: true, message: '请编写资讯内容', trigger: 'blur' },\n          { min: 1, max: 1000000, message: '请编写资讯内容', trigger: 'blur' }\n        ]\n      },\n      setHeader: {\n        token: token\n      }\n    }\n  },\n  mounted () {\n    var self = this\n    tinymce.init({})\n  },\n  activated () {\n    this.tinymceFlag++\n  },\n  methods: {\n    submit () {\n      this.$refs.detailFormAdd.validate((valid) => {\n        if (valid) {\n          appRequestFormData('/sys/cms/save', qs.stringify(this.detailFormAdd), 'post').then((res) => {\n            this.$message(res.data.msg)\n            this.$router.go(-1)\n          })\n        } else {\n          this.$message({\n            type: 'error',\n            message: '请完整表单信息'\n          })\n          return false\n        }\n      })\n    },\n    cancel () {\n      this.$confirm('确定要取消吗？', '确定取消', {\n        type: 'warning'\n      })\n        .then(() => {\n          this.$router.go(-1)\n        })\n    }\n  },\n  created () {\n  }\n}\n</script>\n \n<style lang=\"stylus\">\n .avatar-uploader .el-upload {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n  }\n  .avatar-uploader .el-upload:hover {\n    border-color: #409EFF;\n  }\n  .avatar-uploader-icon {\n    font-size: 28px;\n    color: #8c939d;\n    width: 178px;\n    height: 178px;\n    line-height: 178px;\n    text-align: center;\n  }\n  .avatar {\n    width: 178px;\n    height: 178px;\n    display: block;\n  }\n</style>"]},"metadata":{},"sourceType":"module"}