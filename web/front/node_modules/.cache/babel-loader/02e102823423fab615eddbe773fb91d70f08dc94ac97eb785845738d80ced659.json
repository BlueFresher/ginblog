{"ast":null,"code":"export default {\n  props: ['id'],\n  data() {\n    return {\n      artInfo: {},\n      commentList: [],\n      comment: {\n        content: ''\n      },\n      total: 0,\n      headers: {\n        username: '',\n        user_id: 0\n      },\n      queryParam: {\n        pagesize: 5,\n        pagenum: 1\n      }\n    };\n  },\n  created() {\n    this.getArtInfo();\n    this.getCommnetList();\n    this.headers = {\n      username: window.sessionStorage.getItem('username'),\n      user_id: window.sessionStorage.getItem('user_id')\n    };\n  },\n  methods: {\n    // 查询文章\n    async getArtInfo() {\n      const {\n        data: res\n      } = await this.$http.get(`article/info/${this.id}`);\n      this.artInfo = res.data;\n      console.log(res);\n    },\n    async getCommentList() {\n      const {\n        data: res\n      } = await this.$http.get(`commentfront/${this.id}`, {\n        params: {\n          pagesize: this.queryParam.pagesize,\n          pagenum: this.queryParam.pagenum\n        }\n      });\n      this.commentList = res.data;\n      this.total = res.total;\n    },\n    async pushComment() {\n      const {\n        data: res\n      } = await this.$http.post('addcomment', {\n        article_id: parseInt(this.id),\n        content: this.comment.content,\n        user_id: parseInt(this.headers.user_id),\n        usernanme: this.headers.username\n      });\n      if (res.status !== 200) return this.$message.error(res.message);\n      this.$message.success('评论成功，待审核后显示');\n      this.$router.go(0);\n    }\n  }\n};","map":{"version":3,"mappings":"AAoFA;EACAA;EACAC;IACA;MACAC;MACAC;MACAC;QACAC;MACA;MACAC;MACAC;QACAC;QACAC;MACA;MACAC;QACAC;QACAC;MACA;IACA;EACA;EACAC;IACA;IACA;IACA;MACAL;MACAC;IACA;EACA;EACAK;IACA;IACA;MACA;QAAAb;MAAA;MACA;MACAc;IACA;IAEA;MACA;QAAAd;MAAA;QACAe;UACAL;UACAC;QACA;MACA;MACA;MACA;IACA;IAEA;MACA;QAAAX;MAAA;QACAgB;QACAZ;QACAI;QACAS;MACA;MAEA;MACA;MACA;IACA;EACA;AACA","names":["props","data","artInfo","commentList","comment","content","total","headers","username","user_id","queryParam","pagesize","pagenum","created","methods","console","params","article_id","usernanme"],"sourceRoot":"src/components","sources":["Detail.vue"],"sourcesContent":["<template>\n    <div>\n        <div class=\"d-flex justify-center pa-3 text-h4 font-weight-bold\">{{artInfo.title}}</div>\n            <div class=\"d-flex justify-center align-center\">\n                <div class=\"d-flex mx-10 justify-center\">\n                <v-icon class=\"mr-1\" small>{{'mdi-calendar-month'}}</v-icon>\n                <span>{{artInfo.CreatedAt | dateformat('YYYY-MM-DD')}}</span>\n            </div>\n            \n            <div class=\"d-flex mr-10 justify-center\">\n                <v-icon class=\"mr-1\" color=\"pink\" small>{{ 'mdi-comment' }}</v-icon>\n                <span>{{ total }}</span>\n            </div>\n            <div class=\"d-flex mr-10 justify-center\">\n                <v-icon class=\"mr-1\" color=\"green\" small>{{ 'mdi-eye' }}</v-icon>\n                <span>{{ artInfo.read_count }}</span>\n            </div>\n            </div>\n\n            <v-divider class=\"pa-3 ma-3\"></v-divider>\n\n            <v-alert \n            class=\"ma-4\" \n            elevation=\"1\" \n            color=\"indigo\" \n            dark \n            border=\"left\" \n            outlined>{{artInfo.desc}}</v-alert>\n\n            <div class=\"content ma-5 pa-3 text-justify\" v-html=\"artInfo.content\"></div>\n            \n            <v-divider class=\"ma-5\"></v-divider>\n            <v-sheet class=\"ma-3 pa-3\">\n                <div>\n                  <v-list\n                    outlined\n                    class=\"ma-3 pa-3\"\n                    v-for=\"item in commentList\"\n                    :key=\"item.ID\"\n                    v-show=\"item.status === 1\"\n                  >\n                    <template>\n                      <v-list-item>\n                        <v-list-item-content>\n                          <v-list-item-title>\n                            {{ item.username }}\n                            {{\n                            item.CreatedAt | dateformat('YYYY-MM-DD')\n                            }}\n                          </v-list-item-title>\n                          <v-list-item-subtitle class=\"mr-3\">\n                            {{\n                            item.content\n                            }}\n                          </v-list-item-subtitle>\n                        </v-list-item-content>\n                      </v-list-item>\n                    </template>\n                  </v-list>\n                </div>\n                <div class=\"text-center\" v-if=\"commentList\">\n                  <v-pagination\n                    class=\"my-2\"\n                    total-visible=\"7\"\n                    v-model=\"queryParam.pagenum\"\n                    :length=\"Math.ceil(total / queryParam.pagesize)\"\n                    @input=\"getCommentList()\"\n                  ></v-pagination>\n                </div>\n                <div>\n                  <template>\n                    <v-card flat>\n                      <v-alert v-if=\"!headers.username\" class=\"ma-3\" dense outlined type=\"error\">你还未登录，请登录后留言</v-alert>\n                      <div v-if=\"headers.username\">\n                        <v-textarea class=\"mx-3\" outlined v-model=\"comment.content\"></v-textarea>\n                        <v-btn class=\"ml-3 mb-1\" dark color=\"indigo\" small @click=\"pushComment()\">确定</v-btn>\n                      </div>\n                    </v-card>\n                  </template>\n                </div>\n            </v-sheet>\n    </div>\n</template>\n<script> \nexport default {\n    props: ['id'],\n    data(){\n        return{\n            artInfo:{},\n            commentList: [],\n            comment: {\n                content: ''\n            },\n            total: 0,\n            headers: {\n                username: '',\n                user_id: 0\n            },\n            queryParam: {\n                pagesize: 5,\n                pagenum: 1\n            }\n        }\n    },\n    created(){\n        this.getArtInfo()\n        this.getCommnetList()\n        this.headers = {\n            username: window.sessionStorage.getItem('username'),\n            user_id: window.sessionStorage.getItem('user_id')\n        }\n    },\n    methods:{\n       // 查询文章\n       async getArtInfo() {\n        const {data:res} = await this.$http.get(`article/info/${this.id}`)\n        this.artInfo = res.data\n        console.log(res)\n       }, \n\n       async getCommentList() {\n        const {data:res} = await this.$http.get(`commentfront/${this.id}`, {\n            params: {\n                pagesize: this.queryParam.pagesize,\n                pagenum: this.queryParam.pagenum\n            }\n        })\n        this.commentList = res.data\n        this.total = res.total\n       },\n\n       async pushComment() {\n        const {data: res} = await this.$http.post('addcomment', {\n            article_id: parseInt(this.id),\n            content: this.comment.content,\n            user_id: parseInt(this.headers.user_id),\n            usernanme: this.headers.username\n        })\n\n        if (res.status !== 200) return this.$message.error(res.message)\n            this.$message.success('评论成功，待审核后显示')\n            this.$router.go(0)\n        }\n    }\n}\n</script>\n\n<style scoped>\n.content >>> img,\nspan,\np {\n    width:90%;\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}